
{% extends 'base.html' %}
{% load static %}
{% block content %}



    <div class="container">
        <div class="row">
            <div class="col-lg-12 mb-4 mb-sm-5">
                <div class="card card-style1 border-0">
                    <div class="profile-bg card-body p-1-9 p-sm-2-3 p-md-6 p-lg-7 text-white">
                        <div class="row align-items-center">
                            <div class="col-lg-6 mb-4 mb-lg-0"> 
                                <div class="prof_image">
                                    <img src="{% if req_profile.image %}
                                    {{req_profile.image.url}}
                                    {% else %}
                                    {% static 'img/carbonvise.png' %}
                                    {% endif %}" class="profile_image_act">
                                </div>
                            </div>
                            <div class="col-lg-6 px-xl-10">
                                <div class="d-lg-inline-block py-1-9 px-1-9 px-sm-6 mb-1-9 rounded">
                                    <div class="h2 text-white mb-0 my-3">{{req_profile.user.first_name}} {{req_profile.user.last_name}}</div>
                                    <div class="h4 text-white mb-0 my-3">{% if req_profile.user.is_dealer %}
                                        Dealer

                                        {% else %}
                                        {% endif %}
                                    </div> 
                                </div>
                                <div class="my-3">
                                    <ul class="list-unstyled mb-1-9">
                                        <li class="mb-2 mb-xl-3 display-28"><span class="display-26 text-white me-2 font-weight-600">Province:</span> {{req_profile.user.get_province_name}}</li>
                                        <li class="mb-2 mb-xl-3 display-28"><span class="display-26 text-white me-2 font-weight-600">Experience:</span> 10 Years</li>
                                        <li class="mb-2 mb-xl-3 display-28"><span class="display-26 text-white me-2 font-weight-600">Email:</span> {{req_profile.email}}</li>
                                        <li class="mb-2 mb-xl-3 display-28"><span class="display-26 text-white me-2 font-weight-600">Contacts:</span>None</li>
                                        <li class="display-28"><span class="display-26 text-white me-2 font-weight-600">Phone:</span> 191</li>
                                        <div class="my-5">About me :<br> {{req_profile.about_me}}</div>
                                    </ul>
                                </div>
                            </div>
                        </div>
                            <div class="my-3">  {% if req_profile.user == user %}
                                                    <a href="{% url 'profiles:become_dealer' user.profile.slug  %}" class="site-btn ms-3 me-3">สมัครเป็นดีลเลอร์</a>
 
                                                    <a href="{% url 'profiles:profile_update' user.slug  %}" class="site-btn ms-3 me-3">แก้ไขโปรไฟล์</a>
                                                    {% if req_profile.user.is_dealer %}
                                                    
                                                    <a href="{% url 'market:market_create' %}" class="site-btn me-3">Create deal</a>
                                                    {% else %}
                                                    {% endif %} 

                                                    <a href="{% url 'profiles:start_session' user.profile.slug %}" class="site-btn me-3">start session</a>
                                                    
                                                    
                                                    <a href="{% url 'account_logout' %}" class="site-btn ms-3 ">ออกจากระบบ</a>
                                                
                                                {% else %} 
                                                {% endif %}
                               
                               
                            </div>
                        
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-lg-12 mb-4 mb-sm-5">
                <h2 class="my-3">Session</h2>

                <div class="card card-style1 border-0">
                    <div class="profile-bg card-body p-1-9 p-sm-2-3 p-md-6 p-lg-7 text-white">
                        <div class="row align-items-center">
                            <div class="col-lg-6 mb-4 mb-lg-0"> 
                                <div class="cp-item">
                                    <div class="circle-progress" data-cpid="id-1" data-cpvalue="{{credit_percentage}}" data-cpcolor="#0b1800" data-cpsize="500" data-cptitle="Progress to neutral"></div>
                                </div>
                            
                            </div>
                            <div class="col-lg-6 px-xl-10">
                                <div class="d-lg-inline-block py-1-9 px-1-9 px-sm-6 mb-1-9 rounded">
                                    <div class="h2 text-white mb-0 my-3">Status : {{req_profile.user.profile_credit.is_neutral}}</div>
                                    <!-- <div class="h2 text-white mb-0 my-3">Session Active : {{req_profile.user.profile_credit.session_active}}</div> -->
                                    <div class="h2 text-white mb-0 my-3">Session name : {{req_profile.user.profile_credit.session_name}}</div>
                                    <div class="h4 text-white mb-0 my-5">Session End : {{req_profile.user.profile_credit.reset_date}}</div>

                                    <div class="h4 text-white mb-0 my-3">Your Credits : {{req_profile.user.profile_credit.credits}} Credits</div> 
                                    <div class="h4 text-white mb-0 my-3">Neutral Goal : 1000 Credits</div> 

                                </div>
                                <div class="my-3">  {% if req_profile.user == user %}
                                    {% if not profile_credit == None %}
                                        <a href="{% url 'profiles:end_session' user.profile.slug  %}" class="site-btn ms-3 me-3">End session</a>
                                        {%if profile_credit.badges.is_obtained %}
                                        <a href="{% url 'badges:badge_detail' user.profile_credit.slug  %}" class="site-btn ms-3 me-3">View badge</a>
                                        {% else %}
                                        <a href="{% url 'badges:obtain_badges' %}" class="site-btn ms-3 me-3">obtain badges</a>
                                        {% endif %}
                                        

                                    {% else %}
                                    {% endif %}

                                        
                                        
                                    
                                    {% else %} 
                                    {% endif %}
               
               
                                </div>
                                <ul class="list-unstyled mb-1-9">
                                   
                                </ul>

                            </div>
                        </div>
              
                    </div>
                </div>
            </div>
        </div>            <h2 class="my-3">Session History</h2>
			<div class="box-element">
                
                    <div class="cart-row">
                        <div style="flex:1"><strong>Session name</strong></div>
                        
                        <div style="flex:1"><strong>Credits Obtained</strong></div>
                        
                        <div style="flex:1"><strong>Start date</strong></div>
                        <div style="flex:1"><strong>End date</strong></div>
                        <div style="flex:1"><strong>Status</strong></div>
                        <div style="flex:1"><strong>Badge</strong></div>
                    </div>
                    {% for sess in session_history reversed %}
                    <div class="cart-row">
                        <div style="flex:1"><p>{{sess.session_name}}</p></div>

                        
                        
                        <div style="flex:1"><p>{{sess.credits_of_month}}</p></div>
                        <div style="flex:1"><p>{{sess.start_date}}</p></div>
                        <div style="flex:1">
                            <p class="quantity">{{sess.end_date}}</p>
                            
                        </div>
                        {% if sess.is_neutral %}
                        <div style="flex:1"><p>Neutral</p></div>
                        <div style="flex:1"><a href="{% url 'badges:badge_detail' sess.slug %}" class="site-btn ms-3 me-3">View badges</a></div>
                        {% else %}
                        <div style="flex:1"><p>Not Neutral</p></div>
                        <div style="flex:1"></div>
                        {% endif %}
                        
                    </div>
                    {% endfor %}
			</div>
            <h2 class="my-3">Purchase History</h2>
			<div class="box-element">
                
				<div class="cart-row">
					<div style="flex:1"><strong>Time</strong></div>
					<div style="flex:1"><strong></strong></div>
					<div style="flex:1"><strong>Deal</strong></div>
					<div style="flex:1"><strong>Price</strong></div>
					<div style="flex:1"><strong>Quantity</strong></div>
					<div style="flex:1"><strong>Total</strong></div>
				</div>
				{% for item in purchased_item reversed %}
				<div class="cart-row">
                    <div style="flex:1"><p>{{item.date_dealed}}</p></div>

					<div style="flex:1"><img class="row-image" src="{% if item.qrcode %}
                        {{item.qrcode.url}}
                    {% else %}
                        {% static 'img/carbonvise.png' %}
                    {% endif %}" "></div>
					
					<div style="flex:1"><p>{{item.deal.name}}</p></div>
					<div style="flex:1"><p>฿{{item.deal.price_per_unit}}</p></div>
					<div style="flex:1">
						<p class="quantity">{{item.quantity}}</p>
						
					</div>
					<div style="flex:1"><p>฿{{item.get_total}}</p></div>
				</div>
				{% endfor %}
			</div>


    </div>
          

	



{% endblock %} 